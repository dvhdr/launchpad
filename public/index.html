<!DOCTYPE html>
<!-- HTML5 Hello world by kirupa - http://www.kirupa.com/html5/getting_your_feet_wet_html5_pg1.htm -->
<html lang="en-us">

<head>
<meta charset="utf-8">
<title>Hello...</title>
<style type="text/css">
#mainContent {
	font-family: Arial, Helvetica, sans-serif;
	font-size: xx-large;
	font-weight: bold;
	background-color: #E3F0FB;
	border-radius: 4px;
	padding: 10px;
	text-align: center;
}
.buttonStyle {
	border-radius: 4px;
	border: thin solid #F0E020;
	padding: 5px;
	background-color: #F8F094;
	font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
	font-weight: bold;
	color: #663300;
	width: 75px;
}

.buttonStyle:hover {
	border: thin solid #FFCC00;
	background-color: #FCF9D6;
	color: #996633;
	cursor: pointer;
}
.buttonStyle:active {
	border: thin solid #99CC00;
	background-color: #F5FFD2;
	color: #669900;
	cursor: pointer;
}

</style>
</head>

<body>
<div id="mainContent">
<p id="helloText">?</p>
<button id="clickButton" class="buttonStyle">click me</button>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript" src='./js/remix.js'></script>
<script type="text/javascript">

    // These are the things you need:  an API key, the track ID, and the path to the track
    var apiKey = 'PGCZJJWKLITVGDF9Q';
    var trackID = 'TRCYWPQ139279B3308';
    var trackURL = 'audio/test.mp3';
    
    // Set up the key variables
    var remixer;
    var player;
    var track;

// The main function.
function init() 
{
    // Make sure the browser supports Web Audio.
    if (window.webkitAudioContext === undefined) 
    {
        myText.textContent = "Web Audio is missing :(";
    } 
    else 
    {    
        myText.textContent = "Web Audio OK...";
    
        // These set up the WebAudio playback environment, and create the remixer and player.
        var context = new webkitAudioContext();
        remixer = createJRemixer(context, $, apiKey);
        player = remixer.getPlayer();
        $("#info").text("Loading analysis data...");

        // The key line.  This prepares the track for remixing:  it gets
        // data from the Echo Nest analyze API and connects it with the audio file.
        // All the remixing takes place in the callback function.
        remixer.remixTrackById(trackID, trackURL, function(t, percent)
        {
            track = t;

            // Keep the user update with load times
            $("#info").text(percent + "% of the track loaded");
            if (percent == 100) {
                $("#info").text(percent + "% of the track loaded, remixing...");
            }
                
            // Do the remixing!
            if (track.status == 'ok') 
            {
                $("#info").text("Remix ready! " + track.analysis.beats.length + " beats long");
            }
            
        });
    }
}

// Run the main function once the page is loaded.
window.onload = init;

var myButton = document.getElementById("clickButton");
var myText = document.getElementById("helloText");

var beat = 0;

myButton.addEventListener('click', doSomething, false)

function doSomething() {
	myText.textContent = "Remix!";
    
    
    var playres = player.play(0, track.analysis.beats[beat++]);
}
</script>

<div id='info'> </div>

<!-- These buttons will play and stop your remix.  -->
<button onClick="player.stop()">Stop!</button>

</body>
</html>
















